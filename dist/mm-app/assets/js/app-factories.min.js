function DataFactory(e,t,a){var r={};return r.postMediaDelete=function(a){return e.post(t.postMediaDelete,a)},r.postMediaUpdates=function(a){return e.post(t.postMediaUpdates,a)},r.postVirtualFile=function(a){return e.post(t.postVirtualFile,a)},r.postFolderSave=function(a){return e.post(t.postFolderSave,a)},r.getFolderList=function(){var r=a.defer(),o=Math.floor(50*Math.random())+""+(new Date).getTime();return e.get(t.getMediaListing+"?type=folderList&rand="+o).then(function(e){"status"in e.data?"true"==e.data.status?r.resolve(e.data.data.folders):r.reject(e.data.message):r.resolve(e.data.folders)},function(){r.reject()}),r.promise},r.getMediaListing=function(r){var o=a.defer(),n=Math.floor(50*Math.random())+""+(new Date).getTime();return e.get(t.getMediaListing+"?type=mediaList&folder_id="+r+"&rand="+n).then(function(e){"status"in e.data?"true"==e.data.status?o.resolve(e.data.data.media):o.reject(e.data.message):o.resolve(e.data.media)},function(){o.reject()}),o.promise},r}function FileUploadFactory(e,t,a){this.upload=function(a,r,o){var n=e.defer(),s=new XMLHttpRequest;s.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=e.loaded/e.total*100|0;n.notify({id:o,complete:t})}},!1),s.onreadystatechange=function(e){4===this.readyState&&(200==s.status?t.$apply(function(){n.resolve({id:o,data:JSON.parse(s.response)})}):t.$apply(function(){n.reject({id:o,data:JSON.parse(s.response)})}))};try{s.open("POST",a,!0),s.setRequestHeader("X-FILENAME",r.name),s.send(r)}catch(e){n.reject({id:o,data:{id:o,message:"XHR Error. Check Console"}}),console.log(e)}return n.promise};return this.getTranscodeProgress=function(t,r,o){var n=e.defer();return a({url:t,method:"GET",params:{filename:r,data:o}}).then(function(e){200==e.status&&"OK"==e.statusText?n.resolve(e.data):n.reject(e)},function(e){n.reject(e)}),n.promise},this}angular.module("mediaManager").factory("DataFactory",["$http","APP_CONST","$q",DataFactory]),angular.module("mediaManager").factory("UploadFactory",["$q","$rootScope","$http",FileUploadFactory]);